#!/usr/bin/env node

const fs = require('fs')
const { inspect } = require('util')

const { lex, parse, interp, error } = require('..')

function trace(x) {
  console.log(
    inspect(x, { depth: null, colors: true }))

  return Promise.resolve(x)
}

lex(fs.createReadStream('test/wew.w'))
  .then(trace)
  .then(parse)
  .then(res => res[0])
  .then(trace)
  .then(interp)
  .catch(error.format)
